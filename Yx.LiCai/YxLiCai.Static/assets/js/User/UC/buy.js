define("buy",["jquery","gxdialog"],function(e,a,i){function t(e){y.gxDialog({title:"",width:280,closeBtn:!1,info:'<div class="pop-box"><p class="warning-color">'+e+"</p></div>",ok:function(){}})}function n(e){y.gxDialog({title:"",width:280,closeBtn:!1,info:'<div class="pop-box"><p class="warning-color">'+e+"</p></div>",ok:function(){window.location.href="/UserSetting/uc_setting_status"}})}function o(){y.gxDialog({title:"",width:280,closeBtn:!1,info:"<div class='loading'><p>支付中</p><div class='spinner'><div class='rect1'></div><div class='rect2'></div><div class='rect3'></div><div class='rect4'></div></div></div>"})}function l(){r=window.setInterval(c,3e3)}function c(){p++,window.clearInterval(r),y.ajax({type:"POST",async:!1,url:"/Buy/queryOrderResult",data:{orderId:d},success:function(e){0==e.Status?"0"==e.Message?window.location.href="/Buy/BuyFail?ptype="+s+"&buyMoney="+u:"1"==e.Message?window.location.href="/Buy/BuySuccess?ptype="+s+"&money="+u:3>p&&l():window.location.href="/Buy/BuyFail"},error:function(e,a,i){}})}var r,d,s,u,y=jQuery=e("jquery"),p=(e("gxdialog"),0);y.gxDialog.defaults.background="#000",y("#bindBank").on("click",function(){var e=y("#ptype").val(),a=y("#isRealCard").val();if("1"!=a)return void n("未进行实名认证，请先认证");var i=y("#raisemoney").val();window.location.href="/UserSetting/add_bank?returnUrl=/buy/buyproduct?ptype="+e+"&buyMoney="+i}),y("#fetch_pwd_setting").on("click",function(){var e=y("#ptype").val(),a=y("#raisemoney").val();window.location.href="/UserSetting/fetch_pwd_setting?returnUrl=/buy/buyproduct?ptype="+e+"&buyMoney="+a}),y("#forget_SPFist_pwd").on("click",function(){var e=y("#ptype").val(),a=y("#raisemoney").val();window.location.href="/UserSetting/forget_SPFist_pwd?returnUrl=/buy/buyproduct?ptype="+e+"&buyMoney="+a}),y("#raisemoney").on("input propertychange",function(){var e=y("#raisemoney").val();e=e.replace(/[^\d.]/g,""),e=e.replace(/^\./g,""),e=e.replace(/\.{2,}/g,"."),e=e.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e=e.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),y("#raisemoney").val(e),""==e||parseFloat(e)<100?(y("#buyit").addClass("ui-btn-gray"),y("#buyit").unbind("click")):(y("#buyit").removeClass("ui-btn-gray"),y("#buyit").on("click",function(){y("#sallpwd").val("");var e=y("#raisemoney").val(),a=parseFloat(y("#balance").val()),i=y(".checked").val(),n=y("#AvailableAmount").html();return y("#sallmoney span").html(e),isNaN(e)?void t("请输入买入金额"):""==e.replace(/[ ]/g,"")?void t("请输入买入金额"):(e=parseFloat(e),100>e?void t("买入金额需大于100元"):e>n?void t("输入金额不可大于可购买金额"):1==i&&e>a?void t("余额不足，建议使用银行卡购买"):(y.gxDialog({title:"",width:280,info:document.getElementById("J_buyPwd")}),void y("#sallpwd").focus()))}))}),y(document).ready(function(){y("#buyit").addClass("ui-btn-gray"),y("#okbuy").click(function(){y("#okbuy").hide(),y.gxDialog.close(),y("#okbuy").show();var e=y("#raisemoney").val(),a=y("#ptype").val(),i=y("#addrateids").val(),n=(y("#productid").val(),y("#sallpwd").val()),c=y(".checked").val();return""==n.replace(/[ ]/g,"")?void t("请输入交易密码"):""==e.replace(/[ ]/g,"")?void t("请输入买入金额"):void y.ajax(1==c?{type:"POST",async:!1,url:"/Buy/BalanceBuyProducts",data:{ptype:a,money:e,ids:i,sallpwd:n},success:function(i){return 0!=i.Status?(t(i.Message),!1):(y("#sallpwd").val(""),void(window.location.href="/Buy/BuySuccess?ptype="+a+"&money="+e))},error:function(e,a,i){}}:{type:"POST",async:!1,url:"/Buy/PayBuyProducts",data:{ptype:a,money:e,ids:i,sallpwd:n},success:function(i){return 0!=i.Status?(t(i.Message),!1):(y("#sallpwd").val(""),d=i.Message,s=a,u=e,o(),l(),void 0)},error:function(e,a,i){}})}),y("#buyMoney").click(function(){var e=y("#ptype").val(),a=y("#raisemoney").val(),i=y("#ids").val();window.location.href="/buy/addinterest?ptype="+e+"&buyMoney="+a+"&ids="+i});var e=y("#raisemoney").val();""!=e&&(y("#buyit").removeClass("ui-btn-gray"),y("#buyit").on("click",function(){y("#sallpwd").val("");var e=y("#raisemoney").val(),a=parseFloat(y("#balance").val()),i=y(".checked").val(),n=y("#AvailableAmount").html();return y("#sallmoney span").html(e),isNaN(e)?void t("请输入买入金额"):""==e.replace(/[ ]/g,"")?void t("请输入买入金额"):(e=parseFloat(e),100>e?void t("买入金额需大于100元"):e>n?void t("输入金额不可大于可购买金额"):1==i&&e>a?void t("余额不足，建议使用银行卡购买"):(y.gxDialog({title:"",width:280,info:document.getElementById("J_buyPwd")}),void y("#sallpwd").focus()))}));var a=function(){var e=y(".J_payWay");y.each(e,function(a,i){var t=y(this),n=t.find("input[type=radio]");t.on("click",function(a){a.preventDefault(),n.attr("checked")||(e.find("input[type=radio]").removeAttr("checked").removeClass("checked"),n.attr("checked","checked").addClass("checked"))})})};a()})}),seajs.use("buy");