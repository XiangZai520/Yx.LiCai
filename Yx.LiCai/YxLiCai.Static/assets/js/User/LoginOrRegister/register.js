define("reg",["jquery","gxdialog"],function(e,n,a){function r(e){i.gxDialog({title:"",width:280,closeBtn:!1,info:'<div class="pop-box"><p class="warning-color">'+e+"</p></div>",ok:function(){}})}function t(){i("#repOld").show(),i("#repNew").hide(),d=g,s=window.setInterval(o,1e3),i.ajax({type:"POST",async:!1,url:"/Login/SendValidateCode",data:{account:dianhua},success:function(e){return e?void 0:void r("发送手机验证码失败")},error:function(e,n,a){}});var e=dian.length,n=dian.substr(parseInt(e-4)),a="验证码已发送至您****"+n+"的手机，请耐心等待。";i(".yx-tips").css("display",""),i(".yx-tips").html(a)}function o(){1==d?(window.clearInterval(s),i("#repOld").hide(),i("#repNew").show(),i("#TimeMove").html("60")):(d--,i("#TimeMove").html(d))}{var i=jQuery=e("jquery");e("gxdialog")}i.gxDialog.defaults.background="#000";var s,d,l=/^[0-9a-zA-Z_/]{6,16}$/,c=/^[0-9]{6}$/,u=/^.{6,16}$/,p=i("#inviteCode").val(),g=60;""!=dianhua&&t(),i("#repNewMsg").click(function(){t()}),i("#phoneCode").on("input propertychange",function(){var e=i("#phoneCode").val().replace(/[ ]/g,"");i("#phoneCode").val(e),""==e&&(i("#regBtn").addClass("ui-btn-gray"),i("#regBtn").unbind("click"))}),i("#regPassword").on("input propertychange",function(){i("#regBtn").unbind("click");var e=i("#regPassword").val().replace(/[ ]/g,"");i("#regPassword").val(e),""!=e&&u.test(e)?(i("#regBtn").removeClass("ui-btn-gray"),i("#regBtn").bind("click",function(){var e=i("#phoneCode").val().replace(/[ ]/g,""),n=i("#regPassword").val();return""==e?(r("请输入短信验证码"),!1):c.test(e)?""==n?(r("请设置登录密码"),!1):l.test(n)?void i.ajax({type:"POST",async:!1,url:"/Login/RegisterUser",data:{password:n,Phone:dianhua,InviteCode:p,RandomCode:e},success:function(e){return 0==e.Status?(window.location.href="/Member/",!0):(r(e.Message),!1)},error:function(e,n,a){}}):(r("密码格式错误，请修改为6-16位字母、数字、下划线组合"),!1):(r("验证码输入错误，请修改"),!1)})):i("#regBtn").addClass("ui-btn-gray")}),i(document).ready(function(){i("#regBtn").addClass("ui-btn-gray"),i("#phoneCode").val(""),i("#regPassword").val("")}),i(".show-pwd").on("click",function(e){e.preventDefault();var n=i(this),a=n.hasClass("yes-pwd");a?(n.removeClass("yes-pwd"),n.parent("dd").children("input").attr("type","password")):(n.addClass("yes-pwd"),n.parent("dd").children("input").attr("type","text"))})}),seajs.use("reg");