define("forget_SP_pwd",["jquery","gxdialog"],function(e,n,t){function o(e){s.gxDialog({title:"",width:280,closeBtn:!1,info:'<div class="pop-box"><p class="warning-color">'+e+"</p></div>",ok:function(){}})}function a(){function e(n){window.setTimeout(function(){n--,n>0?(s(".cd-time").html(n),e(n)):(s.gxDialog.close(),window.location.href=""!=d?d:"/UserSetting/")},1e3)}s.gxDialog({title:"",width:280,closeBtn:!1,info:'<div class="pop-box"><h3>修改成功</h3><p>您的交易密码修改成功<p><div class="cd-time">3</div></div>'});var n=3;e(n)}function i(){s("#repOld").show(),s("#repNew").hide(),c=v,l=window.setInterval(r,1e3),s.ajax({type:"POST",async:!1,url:"/Login/SendValidateCode",data:{account:userPhone},success:function(e){e||o("发送验证码失败")},error:function(e,n,t){}})}function r(){1==c?(window.clearInterval(l),s("#repOld").hide(),s("#repNew").show(),s("#TimeMove").html("60")):(c--,s("#TimeMove").html(c))}var s=jQuery=e("jquery"),d=(e("gxdialog"),s("#returnUrl").val());s.gxDialog.defaults.background="#000";var l,c,u=/^[0-9]{6}$/,p=/^.{6}$/,v=60;""!=userPhone&&i(),s("#repNewMsg").click(function(){i()}),s("#phoneCode").on("input propertychange",function(){var e=s("#phoneCode").val();s("#phoneCode").val(e),""==e&&(s("#btnOK").addClass("ui-btn-gray"),s("#btnOK").unbind("click"))}),s("#regPassword").on("input propertychange",function(){s("#btnOK").unbind("click");var e=s("#regPassword").val();s("#regPassword").val(e),""!=e&&p.test(e)&&(s("#btnOK").removeClass("ui-btn-gray"),s("#btnOK").bind("click",function(){var e=s("#phoneCode").val(),n=s("#regPassword").val();return""==e?void o("请输入验证码"):u.test(e)?""==n?void o("请输入新交易密码"):u.test(n)?void s.ajax({type:"POST",async:!1,url:"/UserSetting/ForgetUserSallpassword",data:{PassWord:n,PhoneCode:e},success:function(e){return 0==e.Status?(event.preventDefault(),a(),!0):(o(e.Message),!1)},error:function(e,n,t){}}):void o("交易密码格式错误，请修改为6位数字"):void o("验证码格式错误，请修改为6位数字")}))}),s(document).ready(function(){s("#btnOK").addClass("ui-btn-gray"),s("#phoneCode").val(""),s("#regPassword").val("")}),s(".show-pwd").on("click",function(e){e.preventDefault();var n=s(this),t=n.hasClass("yes-pwd");t?(n.removeClass("yes-pwd"),n.parent("dd").children("input").attr("type","password")):(n.addClass("yes-pwd"),n.parent("dd").children("input").attr("type","text"))})}),seajs.use("forget_SP_pwd");